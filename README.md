# Извлечение информации из изображений

Описание
Веб-приложение предназначено для анализа графических файлов и отображения основных характеристик изображений. Приложение показывает детальную техническую информацию о файлах изображений, включая метаданные, параметры сжатия и цветовые характеристики. Работает полностью в браузере и не требует установки дополнительного программного обеспечения.

Возможности
* Поддержка широкого спектра форматов:
    * JPEG/JPG - с анализом JFIF/EXIF метаданных
    * PNG - с чтением блоков IHDR и pHYs
    * GIF - с анализом палитры и размера
    * BMP - с извлечением информации о битности и разрешении
    * TIFF/TIF - поддержка формата для полиграфии
    * PCX - работа с устаревшим форматом ZSoft
* Массовая обработка файлов:
    * Загрузка целой папки с изображениями через <input type="file" webkitdirectory multiple>
    * Обработка до 100 000 файлов
    * Пакетная обработка с размером батча 50 файлов
    * Защита от дубликатов через Set коллекции
* Извлечение технических характеристик:
    * Размер изображения в пикселях (ширина × высота)
    * Разрешение DPI (из заголовков файлов)
    * Глубина цвета (битность)
    * Метод сжатия данных
* Пользовательский интерфейс:
    * Динамическое построение таблицы с результатами
    * Индикатор прогресса обработки файлов в реальном времени
    * Адаптивный дизайн с фоном "леопардовая шкура"
    * Подсветка четных строк таблицы для улучшения читаемости
* Полностью клиентское приложение - не требует серверной части и работает оффлайн

Технологии
* HTML5 — семантическая структура страницы, элементы форм с атрибутом webkitdirectory
* CSS3 — современное оформление с flexbox, градиентами, тенями и скругленными углами
* JavaScript (ES6+) — асинхронные функции, Set коллекции, деструктуризация
* File API — работа с локальными файлами пользователя через File и FileList
* DataView — низкоуровневое чтение бинарных заголовков файлов
* Image API — анализ размеров изображений через объект Image
* URL.createObjectURL — эффективная загрузка изображений без сервера
* ArrayBuffer — работа с бинарными данными файлов

Алгоритм работы
1. Выбор и валидация файлов

fileInput.addEventListener('change', async (e) => {
  fileQueue = [...e.target.files];
  // Фильтрация по расширениям и MIME-типам
  if (!(file.type.startsWith("image/") || ["pcx","tif","tiff","gif"].includes(ext))) continue;
});


2. Извлечение метаданных по форматам
Для JPEG:

// Поиск маркеров JFIF (0x4A464946) и EXIF (0x011A)
if (view.getUint32(i, false) === 0x4A464946) {
  const units = view.getUint8(i+7);
  const xdpi = view.getUint16(i+8, false);
  if (units === 1) dpi = xdpi + " dpi";
}


Для PNG:

// Чтение блока IHDR для глубины цвета
if (view.getUint32(12, false) === 0x49484452) {
  const bitDepth = view.getUint8(24);
  const colorType = view.getUint8(25);
  let channels = {0:1,2:3,3:1,4:2,6:4}[colorType] || 3;
  depth = (bitDepth * channels) + " бит";
}


Для GIF:

// Анализ палитры и размера
const packed = view.getUint8(10);
const n = packed & 0b00000111;
const colors = 2 ** (n+1);
depth = "8 бит (палитра, " + colors + " цветов)";


Для BMP:

// Чтение заголовка BITMAPINFOHEADER
const xppm = view.getInt32(38, true);
if (xppm > 0) dpi = Math.round(xppm * 0.0254) + " dpi";


3. Определение методов сжатия

let comp = "—";
if (ext.includes("jpg")) comp = "JPEG";
else if (ext.includes("png")) comp = "Deflate (PNG)";
else if (ext.includes("gif")) comp = "LZW (GIF)";
else if (ext.includes("bmp")) comp = "RLE / None (BMP)";


4. Визуализация результатов
* Динамическое создание строк таблицы
* Обновление индикатора прогресса
* Обработка ошибок с выводом "—" для недоступных данных

Архитектура приложения
Обработка в батчах

const BATCH_SIZE = 50;
async function processBatch(total, done) {
  const batch = fileQueue.splice(0, BATCH_SIZE);
  // Обработка батча
  if (fileQueue.length > 0) {
    setTimeout(() => processBatch(total, done), 30);
  }
}


Управление состоянием
* fileQueue - очередь файлов для обработки
* processedFiles - Set для предотвращения дубликатов
* progress - элемент для отображения прогресса

Пример использования
1. Запуск приложения
    * Открыть HTML-файл в современном браузере (Chrome, Firefox, Edge)
    * Дождаться загрузки интерфейса
2. Выбор данных для анализа
    * Нажать кнопку выбора файлов
    * Выбрать папку с изображениями
    * Подождать подсчета файлов
3. Мониторинг процесса
    * Наблюдать за прогрессом обработки в реальном времени
    * Видеть постепенное заполнение таблицы
4. Анализ результатов
    * Просмотреть технические характеристики каждого изображения
    * Сравнить параметры разных форматов
    * Выявить изображения с высоким DPI для печати
Пример результата для JPEG:
text
Файл: photo.jpg
Размер: 1920 × 1080 px
Разрешение: 300 dpi  
Глубина: 24 бит
Сжатие: JPEG



Особенности реализации
* Эффективность - пакетная обработка предотвращает блокировку интерфейса
* Надежность - обработка ошибок для битых файлов
* Точность - прямое чтение заголовков вместо эвристических методов
* Производительность - использование Set для исключения дубликатов
* Пользовательский опыт - индикация прогресса для больших коллекций

Ограничения
* Требуется современный браузер с поддержкой File API
* Некоторые EXIF данные могут быть недоступны в определенных JPEG файлах
* DPI информация отсутствует во многих пользовательских изображениях

Вывод: Разработанное веб-приложение успешно решает задачу анализа технических характеристик изображений, предоставляет точную информацию о файлах различных форматов и предлагает удобный интерфейс для массовой обработки данных. Приложение может использоваться дизайнерами, фотографами и веб-разработчиками для анализа графических материалов.
